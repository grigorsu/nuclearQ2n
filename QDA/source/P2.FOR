C.........................................................
        PROGRAM TESGAU
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        INTEGER LW,LIW
        PARAMETER(LW=8000,LIW=2000)
        INTEGER IW(LIW)
        DOUBLE PRECISION W(LW)
        CHARACTER*10  PROMPT
        CHARACTER*80  STRING
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/ALPHA/ CONAL,CONAL2
        COMMON/CON/ CONSTP,CONSTP2,CONSTP1,CHSH,CHSH2,FINN,FEXX
        COMMON/BBB/ A01,A02,R01,R02,PIA01,PIA02
        COMMON/ANGLE/ BET1,BET2, Y201,Y202,Y401,Y402
        COMMON/ACCUR/ KEY12,KEY13
        COMMON/RO/ RO00
        COMMON/G/ GAM,GAS
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        EXTERNAL FUN1,FUN2,FUN3,FUNU,FUN1A,FUN2A,FUN3A,FUNUA
        DATA  HQC/197.32857/,ENUC/931.5/
        PI=3.141593
        A=0.00001    
        B=30.0     
        EPS=0.001   
        ABS=0.00001
        N=34
        KEY12=1
        KEY13=1
        TET1=0.000       
        TET2=3.140      
        AVAL1=0.0000    
        AVAL2=0.0000     
        DER=0.001
        BET1=0.00        
        BET2=0.00            
        XL=0.
        GAM=0.440       
        GAS=3.00        
        GAMP=0.450
        C0=300.00 
        FIN=0.09      
        FINP=0.42 
        FEX=-2.59
        FEXP=0.54
        SB1=0.55      
        SB1F=0.99      
        SB1Q=0.56     
        SB1FQ=1.00
        SB2=0.59      
        SB2F=1.02      
        SB2Q=0.60     
        SB2FQ=1.11
C         CHARACTER*40 :: args
C         INTEGER :: iii
C         iii = 0
C         HARACTER(len=32) :: ss
C         CALL getarg(0, args)
C         WRITE (*,*) trim(arg) // 'INP.DAT'
C         ss = trim(arg) // 'INP.DAT'
        OPEN (5,FILE='INP.DAT',STATUS='OLD')
         READ (5,15) STRING
         READ (5,10) A1,A2,Z1,Z2
         READ (5,10) A01,A02
         READ (5,10) R0,RO00
C          READ (5,10) A,B,EPS,ABS
C          READ (5,2) N
C          READ (5,2) KEY12, KEY13
C          READ (5,10) TET1,TET2,AVAL1,AVAL2,DER
C          READ (5,10) BET1,BET2,XL
C          READ (5,10) GAM,GAS,GAMP
C          READ (5,10) C0,FIN,FINP,FEX,FEXP
C          READ (5,10) SB1,SB1F,SB1Q,SB1FQ
C          READ (5,10) SB2,SB2F,SB2Q,SB2FQ
         READ (5,16) PROMPT
         FINN= FIN+FINP*(A1-2.*Z1)*(A2-2.*Z2)/A1/A2
         FEXX= FEX+FEXP*(A1-2.*Z1)*(A2-2.*Z2)/A1/A2
 2       FORMAT (2I5)
 10      FORMAT(6D10.5)
 15      FORMAT(A80)
 16      FORMAT(A10)
        OPEN (6,FILE=PROMPT,STATUS='UNKNOWN')
        XMUE=A1*A2/(A1+A2)
        XMUEM=XMUE*ENUC
        FIF1=((1.+BET1*DSQRT(5./4./PI))*(1.-BET1*DSQRT(5./16./PI))**2)
     /  **(-0.3333333)
        FIF2=((1.+BET2*DSQRT(5./4./PI))*(1.-BET2*DSQRT(5./16./PI))**2)
     /  **(-0.3333333)
        R01 = R0*(A1**0.333333)*FIF1
        IF (Z1.EQ.2.) R01 = 1.02*(A1**0.333333)*FIF1
        IF (Z1.EQ.3.) R01 = 1.06*(A1**0.333333)*FIF1
        IF (Z1.EQ.4.) R01 = 1.10*(A1**0.333333)*FIF1
        R02 = R0*(A2**0.333333)*FIF2
        AAX1=R01*(1.+BET1*DSQRT(5./4./PI))
        BAX1=R01*(1.-BET1*DSQRT(5./16./PI))
        AAX2=R02*(1.+BET2*DSQRT(5./4./PI))
        BAX2=R02*(1.-BET2*DSQRT(5./16./PI))
      SMAS1=0.2*A1*ENUC
      SMAS2=0.2*A2*ENUC
      SJ1=SMAS1*(AAX1*AAX1+BAX1*BAX1)
      SJ2=SMAS2*(AAX2*AAX2+BAX2*BAX2)
      SJ1=SJ1*DCOS(TET1)**2+2.*BAX1**2*DSIN(TET1)**2*SMAS1
      SJ2=SJ2*DCOS(TET2)**2+2.*BAX2**2*DSIN(TET2)**2*SMAS2
        R01I = R01*(1.+BET1*DSQRT(5./16./PI)*
     /   (3.*DCOS(AVAL1)**2-1.))*DCOS(TET1-AVAL1)
        R02I = R02*(1.+BET2*DSQRT(5./16./PI)*
     /   (3.*DCOS(AVAL2)**2-1.))*DCOS(PI-TET2-AVAL2)
        CON14=R02*R02/2.*BET2*BET2*(3.*DCOS(AVAL2)*DCOS(AVAL2)-1.)**2*
     /   5./16./PI
        CON16=R01*R01/2.*BET1*BET1*(3.*DCOS(AVAL1)*DCOS(AVAL1)-1.)**2*
     /   5./16./PI
        CON15=R01*R02*BET1*BET2*(3.*DCOS(AVAL1)*DCOS(AVAL1)-1.)*
     /   (3.*DCOS(AVAL2)*DCOS(AVAL2)-1.)*5./16./PI
        CON17=R02*R02/2.*R01*BET1*BET2**2*
     /   (3.*DCOS(AVAL1)*DCOS(AVAL1)-1.)*
     /   (3.*DCOS(AVAL2)*DCOS(AVAL2)-1.)**2*(5./16./PI)**1.5
        CON18=R01*R01/2.*R02*BET2*BET1**2*
     /   (3.*DCOS(AVAL2)*DCOS(AVAL2)-1.)*
     /   (3.*DCOS(AVAL1)*DCOS(AVAL1)-1.)**2*(5./16./PI)**1.5
        CON19=R01*R01/2.*R02*R02/2.*BET2**2*BET1**2*
     /   (3.*DCOS(AVAL2)*DCOS(AVAL2)-1.)**2*
     /   (3.*DCOS(AVAL1)*DCOS(AVAL1)-1.)**2*(5./16./PI)**2
        Y201=3.*DCOS(TET1)*DCOS(TET1)-1.
        Y202=3.*DCOS(TET2)*DCOS(TET2)-1.
        Y401=35.*DCOS(TET1)*DCOS(TET1)*DCOS(TET1)*DCOS(TET1)-30.
     /  *DCOS(TET1)*DCOS(TET1)+3.
        Y402=35.*DCOS(TET2)*DCOS(TET2)*DCOS(TET2)*DCOS(TET2)-30.
     /  *DCOS(TET2)*DCOS(TET2)+3.
        PIA01 = PI*A01
        PIA02 = PI*A02
        CONST12 = 1./(2.0*PI)*RO00*A01
        CONST13 = 1./(2.0*PI)*RO00*A02*R02
        CONST22 = 1./(2.0*PI)*RO00*A02
        CONST23 = 1./(2.0*PI)*RO00*A01*R01
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*A02
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*A01
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C
        WRITE(6,15) STRING
        WRITE (6,*)
        WRITE(6,*) '  A1  =',A1,' A2 = ',A2
        WRITE (6,*)
        WRITE(6,*) '  R0  = ',R0,' RO00 = ',RO00
        WRITE (6,*)
        WRITE(6,*) '  R1  = ',R01,' R2 = ',R02
        WRITE (6,*)
        WRITE(6,*) '  A01  = ',A01,' A02 = ',A02
        WRITE (6,*)
        WRITE(6,*) ' R(fermi)   V_C(MeV)   V_N(Mev)      V(MeV)'
C         WRITE(6,*) '  GAM = ',GAM,' GAMP = ',GAMP,' GAS=',GAS
C         WRITE (6,*)
C         WRITE(6,*) '  TET1 = ',TET1,' TET2 = ',TET2
C         WRITE (6,*)
C         WRITE(6,*) '  AVAL1 = ',AVAL1,' AVAL2 = ',AVAL2
C         WRITE (6,*)
C         WRITE(6,*) ' BET1 = ',BET1,' BET2 = ',BET2
        DO 150 I=1,25
        R = R01I + R02I + 0.2*(I-1)-0.5
        DELTA=R-R01-R02
        VC=COUL(Z1,Z2,R01,R02,BET1,BET2,R,Y201,Y202)
        CONSTP1 = -8.0*PI*RO00*RO00*RO00/R*A01*A01*A02
        KEYS=0
        RESULT1=0.
        RESULT2=0.
        RESULT3=0.
        RI12S=0.
        RI33S=0.
        RI12S1=0.
        RI33S1=0.
        RI12S5=0.
        RI33S5=0.
        IF(A1.GT.2.) THEN
        IF(BET1.EQ.0..AND.BET2.EQ.0.) GO TO 20
        IF(DABS(DELTA).LE.5.5) THEN
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        IF(CON14.EQ.0.) GO TO 30
        KEYS=2
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*SB2*SB2F
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*A01*SB2FQ
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES00, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R02=R02-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*SB2*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0M, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R02=R02+2.*DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*SB2*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0P, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        R02=R02-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*A02
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*A01
        RES011=CON14*(RES0P-2.*RES00+RES0M)/DER/DER
  30    IF(CON16.EQ.0.) GO TO 31
        KEYS=1
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*A02*SB1FQ
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*SB1*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES00, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01-DER
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*SB1*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0M, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01+2.*DER
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*SB1*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0P, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*A02
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*A01
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        RES022=CON16*(RES0P-2.*RES00+RES0M)/DER/DER
   31   IF(CON15.EQ.0.) GO TO 52
        KEYS=3
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES00, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01+DER
        R02=R02+DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0P, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01-DER
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0M1, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01+DER
        R02=R02-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0M2, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01-DER
        R01=R01+DER
        R02=R02-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0PM, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01-DER
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES00M, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01-DER
        R02=R02+2.*DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*SB2Q*SB2Q*SB1*SB2FQ*SB1F
        CHSH = -DCOSH(R01/SB1Q)/DSINH(R01/SB1Q)/SB1Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0MP, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R02=R02-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0M0, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R02=R02-DER
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*SB1Q*SB1Q*SB2*SB1FQ*SB2F
        CHSH2 = -DCOSH(R02/SB2Q)/DSINH(R02/SB2Q)/SB2Q
        CALL D01AKF(FUNU, A, B, ABS, EPS, RES0MM, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNU'
        R01=R01+DER
        R02=R02+DER
        CONSTP2 = -8.0*PI*PI*RO00*RO00*RO00*R01*A02*A02*A01
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CONSTP = -8.0*PI*PI*RO00*RO00*RO00*R02*A01*A01*A02
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
        RES055=CON15*(RES0P-RES0M1-RES0M2+RES00)/DER/DER
        RES077=CON17*(RES0P-2.*RES0M2+RES0PM-RES0M1+2.*RES00-RES00M)/
     /   DER**3
        RES088=CON18*(RES0P-2.*RES0M1+RES0MP-RES0M2+2.*RES00-RES0M0)/
     /   DER**3
        RES099=CON19*(RES0P-2.*RES0M2+RES0PM-2.*RES0M1+4.*RES00-
     /   2.*RES00M+RES0MP-2.*RES0M0+RES0MM)/DER**4
        ELSE
        ENDIF
C
  52    CALL D01AKF(FUN1, A, B, ABS, EPS, RESULT1, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUN1'
C
        CALL D01AKF(FUN2, A, B, ABS, EPS, RESULT2, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUN2'
C
        CALL D01AKF(FUN3, A, B, ABS, EPS, RESULT3, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUN3'
  20    IF(DABS(DELTA).LE.5.5) THEN
        IF(BET1.EQ.0..AND.BET2.EQ.0.) CALL D01AKF(FUNU, A, B,
     *  ABS, EPS, RES0, ABSERR, W, LW, IW, LIW, IFAIL)
        IF (0.NE.0) WRITE(*,*) RES011,RES022,RES055,RES077,RES088,RES099
C         WRITE(*,*) 'RE11',RES011,'RE22',RES022,'RE55',RES055,
C      /   'RE77',RES077,'RE88',RES088,'RE99',RES099
C         WRITE(*,*) 'R',R,'RES00',RES0
        RES0=C0*(RES0+RES011+RES022+RES055+RES077+RES088+RES099+
     /   (FINN-FEXX)/RO00*(RESULT1+RESULT2)+FEXX*RESULT3)
C         WRITE(*,*) 'RE1',RESULT1,'RE2',RESULT2,'RE3',RESULT3
C         WRITE(*,*) 'RES0',RES0
        ELSE
        IF (A01.NE.A02) THEN
        IF (DELTA.GE.0) THEN
             CALL SYM_GT(RI11,RI22,RI33)
C        WRITE(*,*) 'Ri11',Ri11,'RI22',RI22
C        WRITE(*,*) 'R02',R02,'DER',DER
	  IF(CON14.EQ.0..AND.CON16.EQ.0.) GO TO 34
	  UA01=A01
	  UA02=A02
        A01=(UA01*UA02*SB1*SB1Q*SB2*SB2Q)**0.1666666
	  A02=A01
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_GT(RI111,RI222,RI333)
         IF(CON14.EQ.0.)GO TO 32
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C         WRITE(*,*) 'R02',R02,'DER',DER
             CALL SUMEQ_GT(RI11M,RI22M,RI33M)
C         WRITE(*,*) 'Ri11M',Ri11M,'RI22M',RI22M
        R02=R02+2.*DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C         WRITE(*,*) 'R02',R02,'DER',DER
             CALL SUMEQ_GT(RI11P,RI22P,RI33P)
C         WRITE(*,*) 'Ri11P',Ri11P,'RI22P',RI22P
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C        WRITE(*,*) 'Ri11',Ri11,'RI22',RI22
C        WRITE(*,*) 'Ri11M',Ri11M,'RI22M',RI22M
C        WRITE(*,*) 'Ri11P',Ri11P,'RI22P',RI22P
        RI12S=CON14*(RI11P*SB2F+RI22P*SB2FQ-2.*RI111*SB2F-
     /   2.*RI222*SB2FQ+RI11M*SB2F+RI22M*SB2FQ)/DER/DER
        RI33S=CON14*(RI33P-2.*RI333+RI33M)/DER/DER*SB2F
  32    IF(CON16.EQ.0.) GO TO 33
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_GT(RI11M,RI22M,RI33M)
        R01=R01+2.*DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_GT(RI11P1,RI22P1,RI33P1)
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        RI12S1=CON16*(RI11P1*SB1FQ+RI22P1*SB1F-2.*RI111*SB1FQ-
     /   2.*RI222*SB1F+RI11M*SB1FQ+RI22M*SB1F)/DER/DER
        RI33S1=CON16*(RI33P1-2.*RI333+RI33M)/DER/DER*SB1F
   33   IF(CON15.EQ.0.)GO TO 341
        R01=R01+DER
        R02=R02+DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_GT(RI11M,RI22M,RI33M)
        R01=R01-DER
        R02=R02-DER
        RI12S5=CON15*(RI11M*SB1FQ*SB2F+RI22M*SB1F*SB2FQ-
     /   RI11P*SB1FQ*SB2F-RI22P*SB1F*SB2FQ-RI11P1*SB1FQ*SB2F-
     /   RI22P1*SB1F*SB2FQ+RI111*SB1FQ*SB2F+RI222*SB1F*SB2FQ)/DER/DER
        RI33S5=CON15*(RI33M-RI33P-RI33P1+RI333)/DER/DER*SB1F*SB2F
  341   A01=UA01
	  A02=UA02
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
  34    CONTINUE
        ELSE
C          WRITE(*,*) 'LT'
             CALL SYM_LT(RI11,RI22,RI33)
	  IF(CON14.EQ.0..AND.CON16.EQ.0.) GO TO 37
	  UA01=A01
	  UA02=A02
        A01=(UA01*UA02*SB1*SB1Q*SB2*SB2Q)**0.1666666
	  A02=A01
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI111,RI222,RI333)
         IF(CON14.EQ.0.)GO TO 35
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI11M,RI22M,RI33M)
        R02=R02+2.*DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI11P,RI22P,RI33P)
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
        RI12S=CON14*(RI11P*SB2F+RI22P*SB2FQ-2.*RI111*SB2F-
     /   2.*RI222*SB2FQ+RI11M*SB2F+RI22M*SB2FQ)/DER/DER
        RI33S=CON14*(RI33P-2.*RI333+RI33M)/DER/DER*SB2F
  35    IF(CON16.EQ.0.) GO TO 36
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_LT(RI11M,RI22M,RI33M)
        R01=R01+2.*DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_LT(RI11P1,RI22P1,RI33P1)
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        RI12S1=CON16*(RI11P1*SB1FQ+RI22P1*SB1F-2.*RI111*SB1FQ-
     /   2.*RI222*SB1F+RI11M*SB1FQ+RI22M*SB1F)/DER/DER
        RI33S1=CON16*(RI33P1-2.*RI333+RI33M)/DER/DER*SB1F
   36   IF(CON15.EQ.0.)GO TO 371
        R01=R01+DER
        R02=R02+DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI11M,RI22M,RI33M)
        R01=R01-DER
        R02=R02-DER
        RI12S5=CON15*(RI11M*SB1FQ*SB2F+RI22M*SB1F*SB2FQ-
     /   RI11P*SB1FQ*SB2F-RI22P*SB1F*SB2FQ-RI11P1*SB1FQ*SB2F-
     /   RI22P1*SB1F*SB2FQ+RI111*SB1FQ*SB2F+RI222*SB1F*SB2FQ)/DER/DER
        RI33S5=CON15*(RI33M-RI33P-RI33P1+RI333)/DER/DER*SB1F*SB2F
  371   A01=UA01
	  A02=UA02
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
  37    CONTINUE
        ENDIF
        ELSE
        IF (DELTA.GE.0.) THEN
             CALL SUMEQ_GT(RI11,RI22,RI33)
        IF(CON14.EQ.0..AND.CON16.EQ.0.) GO TO 40
	  UA01=A01
	  UA02=A02
        A01=(UA01*UA02*SB1*SB1Q*SB2*SB2Q)**0.1666666
	  A02=A01
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_GT(RI111,RI222,RI333)
C        WRITE(*,*) 'Ri11',Ri111,'RI22',RI222
C        WRITE(*,*) 'R02',R02,'DER',DER
         IF(CON14.EQ.0.)GO TO 38
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C         WRITE(*,*) 'R02',R02,'DER',DER
             CALL SUMEQ_GT(RI11M,RI22M,RI33M)
C         WRITE(*,*) 'Ri11M',Ri11M,'RI22M',RI22M
        R02=R02+2.*DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C         WRITE(*,*) 'R02',R02,'DER',DER
             CALL SUMEQ_GT(RI11P,RI22P,RI33P)
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
C         WRITE(*,*) 'R02',R02,'DER',DER
C         WRITE(*,*) 'Ri11P',Ri11P,'RI22P',RI22P
        RI12S=CON14*(RI11P*SB2F+RI22P*SB2FQ-2.*RI111*SB2F-
     /   2.*RI222*SB2FQ+RI11M*SB2F+RI22M*SB2FQ)/DER/DER
        RI33S=CON14*(RI33P-2.*RI333+RI33M)/DER/DER*SB2F
  38    IF(CON16.EQ.0.) GO TO 39
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_GT(RI11M,RI22M,RI33M)
        R01=R01+2.*DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_GT(RI11P1,RI22P1,RI33P1)
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        RI12S1=CON16*(RI11P1*SB1FQ+RI22P1*SB1F-2.*RI111*SB1FQ-
     /   2.*RI222*SB1F+RI11M*SB1FQ+RI22M*SB1F)/DER/DER
        RI33S1=CON16*(RI33P1-2.*RI333+RI33M)/DER/DER*SB1F
   39   IF(CON15.EQ.0.)GO TO 401
        R01=R01+DER
        R02=R02+DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_GT(RI11M,RI22M,RI33M)
        R01=R01-DER
        R02=R02-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
        RI12S5=CON15*(RI11M*SB1FQ*SB2F+RI22M*SB1F*SB2FQ-
     /   RI11P*SB1FQ*SB2F-RI22P*SB1F*SB2FQ-RI11P1*SB1FQ*SB2F-
     /   RI22P1*SB1F*SB2FQ+RI111*SB1FQ*SB2F+RI222*SB1F*SB2FQ)/DER/DER
        RI33S5=CON15*(RI33M-RI33P-RI33P1+RI333)/DER/DER*SB1F*SB2F
 401    A01=UA01
        A02=UA02
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
  40    CONTINUE
        ELSE
             CALL SUMEQ_LT(RI11,RI22,RI33)
        IF(CON14.EQ.0..AND.CON16.EQ.0.) GO TO 43
	  UA01=A01
	  UA02=A02
        A01=(UA01*UA02*SB1*SB1Q*SB2*SB2Q)**0.1666666
	  A02=A01
             CALL SUMEQ_LT(RI111,RI222,RI333)
         IF(CON14.EQ.0.)GO TO 41
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI11M,RI22M,RI33M)
        R02=R02+2.*DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI11P,RI22P,RI33P)
        R02=R02-DER
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
        RI12S=CON14*(RI11P*SB2F+RI22P*SB2FQ-2.*RI111*SB2F-
     /   2.*RI222*SB2FQ+RI11M*SB2F+RI22M*SB2FQ)/DER/DER
        RI33S=CON14*(RI33P-2.*RI333+RI33M)/DER/DER*SB2F
  41    IF(CON16.EQ.0.) GO TO 42
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_LT(RI11M,RI22M,RI33M)
        R01=R01+2.*DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
             CALL SUMEQ_LT(RI11P1,RI22P1,RI33P1)
        R01=R01-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        RI12S1=CON16*(RI11P1*SB1FQ+RI22P1*SB1F-2.*RI111*SB1FQ-
     /   2.*RI222*SB1F+RI11M*SB1FQ+RI22M*SB1F)/DER/DER
        RI33S1=CON16*(RI33P1-2.*RI333+RI33M)/DER/DER*SB1F
   42   IF(CON15.EQ.0.)GO TO 431
        R01=R01+DER
        R02=R02+DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
             CALL SUMEQ_LT(RI11M,RI22M,RI33M)
        R01=R01-DER
        R02=R02-DER
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
        RI12S5=CON15*(RI11M*SB1FQ*SB2F+RI22M*SB1F*SB2FQ-
     /   RI11P*SB1FQ*SB2F-RI22P*SB1F*SB2FQ-RI11P1*SB1FQ*SB2F-
     /   RI22P1*SB1F*SB2FQ+RI111*SB1FQ*SB2F+RI222*SB1F*SB2FQ)/DER/DER
        RI33S5=CON15*(RI33M-RI33P-RI33P1+RI333)/DER/DER*SB1F*SB2F
 431    A01=UA01
        A02=UA02
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        CHSH2 = -DCOSH(R02/A02)/DSINH(R02/A02)/A02
  43    CONTINUE
        ENDIF
        ENDIF
        RES0=C0*((FINN-FEXX)/RO00*(RI11+RESULT1+RI22+RESULT2+
     /   RI12S+RI12S1+RI12S5)+
     /   FEXX*((RI33+RI33S+RI33S1+RI33S5)/RO00+RESULT3))
        ENDIF
C-------------
        ELSE
        CONAL = 16.*4.*PI*(GAM*GAM/PI)**3*RO00*A1*A1/16.
        CONAL2 = 4.*4.*PI*(GAM*GAM/PI)**(1.5)*RO00*A1/4.
        IF(A2.LE.16.) GO TO 201
        IF(BET2.EQ.0.) GO TO 21
C
        CALL D01AKF(FUN1A, A, B, ABS, EPS, RESULT1, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUN1A'
        WRITE(*,*) '1A'
C
        CALL D01AKF(FUN2A, A, B, ABS, EPS, RESULT2, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUN2A'
        WRITE(*,*) '2A'
C
        CALL D01AKF(FUN3A, A, B, ABS, EPS, RESULT3, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUN3A'
        WRITE(*,*) '3A'
  21    IF(DABS(R-R02).LE.12.15) THEN
        CALL D01AKF(FUNUA, A, B, ABS, EPS, RES0, ABSERR, W,
     *  LW, IW, LIW, IFAIL)
        IF(IFAIL.NE.0) WRITE(6,*) 'IFAIL=',IFAIL, 'FUNUA'
        RES0=C0*(RES0+(FINN-FEXX)/RO00*(RESULT1*A1*A1/16.+
     /   RESULT2*A1/4.)+FEXX*RESULT3*A1/4.)
        WRITE(*,*) 'R',R,'RES0',RES0,'CONAL',CONAL,'CONAL2',CONAL2
        ELSE
        IF (R.GT.R02) THEN
         A01=1./1.414/GAS/GAM
        PIA01 = PI*A01
             CALL SUMAL_GT(RI11)
         A01=1./GAS/GAM
        PIA01 = PI*A01
             CALL SUMALP_GT(RI22)
             CALL SUMAL_GT(RI33)
        RES0=C0*((FINN-FEXX)/RO00*((RI11+RESULT1)*A1*A1/16.+
     /   (RI22+RESULT2)*A1/4.)+FEXX*A1/4.*
     /   (RI33/4./(GAM*GAM/PI)**1.5+RESULT3))
C        WRITE(*,*) 'RES1',RESULT1,'RES2',RESULT2,'RES3',RESULT3
C         WRITE(*,*) 'R',R,'R02',R02,'A1',A1
C         WRITE(*,*) 'RI11',RI11,'RI22',RI22,'RI33',RI33
        ELSE
         A01=1./1.414/GAS/GAM
        PIA01 = PI*A01
             CALL SUMAL_LT(RI11)
         A01=1./GAS/GAM
        PIA01 = PI*A01
             CALL SUMALP_LT(RI22)
             CALL SUMAL_LT(RI33)
        RES0=C0*((FINN-FEXX)/RO00*((RI11+RESULT1)*A1*A1/16.+
     /   (RI22+RESULT2)*A1/4.)+FEXX*A1/4.*
     /   (RI33/4./(GAM*GAM/PI)**1.5+RESULT3))
        ENDIF
        ENDIF
        GO TO 202
 201    RI11=32.*(GAM*GAM/PI)**3*(GAMP*GAMP/PI)**1.5*
     /  DSQRT(PI/(2.*GAM*GAM+GAMP*GAMP))/(2.*GAM*GAM+GAMP*GAMP)*
     /  DEXP(-GAMP*GAMP*(1.-GAMP*GAMP/(2.*GAM*GAM+GAMP*GAMP))*R*R)
        RI22=32.*(GAMP*GAMP/PI)**3*(GAM*GAM/PI)**1.5*
     /  DSQRT(PI/(2.*GAMP*GAMP+GAM*GAM))/(2.*GAMP*GAMP+GAM*GAM)*
     /  DEXP(-GAM*GAM*(1.-GAM*GAM/(2.*GAMP*GAMP+GAM*GAM))*R*R)
        RI33=8.*(GAM*GAM/PI)**1.5*(GAMP*GAMP/PI)**1.5*
     /  DSQRT(PI/(GAMP*GAMP+GAM*GAM))/(GAMP*GAMP+GAM*GAM)*
     /  DEXP(-GAM*GAM*GAMP*GAMP/(GAMP*GAMP+GAM*GAM)*R*R)
        RES0=2.*PI*C0*((FINN-FEXX)/RO00*(RI11*A1*A1*A2/16./4.+
     /   RI22*A1*A2*A2/4./16.)+FEXX*RI33*A1*A2/16.)
 202    CONTINUE
        ENDIF
      SJ12=XMUEM*R**2
C      VROT=HQC**2*XL*(XL+1.)*SJ12/2./(SJ12+SJ1+SJ2)**2
      VROT=HQC**2*XL*(XL+1.)/2./(SJ12+SJ1+SJ2)
        VT=VC+RES0+VROT
        WRITE(6,3) R,VC,RES0,VT
 150    CONTINUE
   3    FORMAT(1X,F6.2,4F12.4)
        STOP
        END

        DOUBLE PRECISION FUNCTION FUN1(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/BBB/ AA01,AA02,RR01,RR02,PPIA01,PPIA02
        COMMON/RO/ RO00
        COMMON/ANGLE/ BET1,BET2, YY201,YY202,YY401,YY402
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        A01=AA01
        A02=AA02
        R01=RR01
        R02=RR02
        PIA01=PPIA01
        PIA02=PPIA02
        PIA1=PI*SB1Q
        PIA2=PI*SB2
        Y201 = YY201
        Y202 = YY202
        FC = 16.*PI*PI*RO00*RO00
        IF(BET2.EQ.0.) THEN
        FUN1= FC*SB1Q*R01*BET1*DSQRT(5./4./PI)/2.*CONST13*Y201*SB1FQ*
     /   FUN13(P,SB1Q,A02,R01,R02,PIA1,PIA02)
         RETURN
         ELSE
         ENDIF
        IF(BET1.EQ.0.) THEN
        FUN1=-FC*A01*R02*BET2*DSQRT(5./4./PI)/2.*CONST12*SB2F*
     /   Y202*FUN12(P,A01,SB2,R01,R02,PIA01,PIA2)
         RETURN
         ELSE
         ENDIF
        FUN1=-FC*A01*R02*BET2*DSQRT(5./4./PI)/2.*CONST12*SB2F*
     /   Y202*FUN12(P,A01,SB2,R01,R02,PIA01,PIA2)+
     /   FC*R01*SB1Q*BET1*DSQRT(5./4./PI)/2.*CONST13*Y201*SB1FQ*
     /   FUN13(P,SB1Q,A02,R01,R02,PIA1,PIA02)
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN2(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST22,CONST23,CONST12,CONST13,PI,N
        COMMON/BBB/ AA02,AA01,RR02,RR01,PPIA02,PPIA01
        COMMON/RO/ RO00
        COMMON/ANGLE/ BET2,BET1, YY202,YY201,YY402,YY401
        COMMON/CORR/ SB2,SB2F,SB2Q,SB2FQ, SB1,SB1F,SB1Q,SB1FQ, KEYS
        A01=AA01
        A02=AA02
        R01=RR01
        R02=RR02
        PIA01=PPIA01
        PIA02=PPIA02
        PIA1=PI*SB1Q
        PIA2=PI*SB2
        Y201 = YY201
        Y202 = YY202
        FC = 16.*PI*PI*RO00*RO00
        IF(BET2.EQ.0.) THEN
        FUN2= FC*SB1Q*R01*BET1*DSQRT(5./4./PI)/2.*CONST13*Y201*SB1FQ*
     /   FUN13(P,SB1Q,A02,R01,R02,PIA1,PIA02)
         RETURN
         ELSE
         ENDIF
        IF(BET1.EQ.0.) THEN
        FUN2=-FC*A01*R02*BET2*DSQRT(5./4./PI)/2.*CONST12*SB2F*
     /   Y202*FUN12(P,A01,SB2,R01,R02,PIA01,PIA2)
         RETURN
         ELSE
         ENDIF
        FUN2=-FC*A01*R02*BET2*DSQRT(5./4./PI)/2.*CONST12*SB2F*
     /   Y202*FUN12(P,A01,SB2,R01,R02,PIA01,PIA2)+
     /   FC*R01*SB1Q*BET1*DSQRT(5./4./PI)/2.*CONST13*Y201*SB1FQ*
     /   FUN13(P,SB1Q,A02,R01,R02,PIA1,PIA02)
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN3(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/BBB/ AA01,AA02,RR01,RR02,PPIA01,PPIA02
        COMMON/RO/ RO00
        COMMON/ANGLE/ BET1,BET2, YY201,YY202,YY401,YY402
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        A01=AA01
        A02=AA02
        R01=RR01
        R02=RR02
        PIA01=PPIA01
        PIA02=PPIA02
        PIA1=PI*SB1
        PIA2=PI*SB2
        Y201 = YY201
        Y202 = YY202
        FC = 16.*PI*PI*RO00
        IF(BET2.EQ.0.) THEN
        FUN3= FC*R01*BET1*DSQRT(5./4./PI)/2.*CONST22*Y201*SB1F*
     /   FUN32(P,SB1,R02,R01,PIA02,PIA1)
         RETURN
         ELSE
         ENDIF
        IF(BET1.EQ.0.) THEN
        FUN3=FC*R02*BET2*DSQRT(5./4./PI)/2.*CONST12*SB2F*
     /   Y202*FUN32(P,SB2,R01,R02,PIA01,PIA2)
         RETURN
         ELSE
         ENDIF
        FUN3=FC*R02*BET2*DSQRT(5./4./PI)/2.*CONST12*SB2F*
     /   Y202*FUN32(P,SB2,R01,R02,PIA01,PIA2)+
     /   FC*R01*BET1*DSQRT(5./4./PI)/2.*CONST22*Y201*SB1F*
     /   FUN32(P,SB1,R02,R01,PIA02,PIA1)
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN1A(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/BBB/ AA01,AA02,RR01,RR02,PPIA01,PPIA02
        COMMON/RO/ RO00
        COMMON/ANGLE/ BET1,BET2, Y201,YY202,Y401,YY402
        COMMON/G/ GAM,GAS
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        A01=AA01
        A02=SB2
        R01=RR01
        R02=RR02
        Y202 = YY202
        Y402 = YY402
        X=4.*GAM*GAM*P*R
        EX=DEXP((P-R02)/A02)
        FC = 16.*(GAM*GAM/PI)**3*SB2F
        FUN1A=FC*R02*BET2*DSQRT(5.*PI)*Y202*RO00/A02*P*P*
     /  DEXP(-2.*GAM*GAM*(P*P+R*R))*
     /  ((3./X/X/X+1./X)*DSINH(X)-3./X/X*DCOSH(X))*
     /  EX/(1.+EX)/(1.+EX)+
     /   FC*BET2*BET2*R02*R02/2.*
     /   FUN34A(P,A02,R02,Y202,Y402,2.D0)*RO00/A02/A02
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN2A(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/BBB/ AA01,AA02,RR01,RR02,PPIA01,PPIA02
        COMMON/RO/ RO00
        COMMON/ANGLE/ BET1,BET2, Y201,YY202,Y401,YY402
        COMMON/G/ GAM,GAS
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        A01=AA01
        A02=SB2Q
        R01=RR01
        R02=RR02
        Y202 = YY202
        Y402 = YY402
        X=2.*GAM*GAM*P*R
        EX=DEXP((P-R02)/A02)
        FC = RO00*RO00*4.*(GAM*GAM/PI)**1.5*SB2FQ
        FUN2A=FC*R02*BET2*DSQRT(5.*PI)*Y202/A02*P*P*
     /  DEXP(-GAM*GAM*(P*P+R*R))*
     /  ((3./X/X/X+1./X)*DSINH(X)-3./X/X*DCOSH(X))*
     /  2.*EX/(1.+EX)/(1.+EX)/(1.+EX)+
     /   FC*BET2*BET2*R02*R02/2.*
     /   FUN16A(P,A02,R02,Y202,Y402)/A02/A02
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN3A(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/BBB/ AA01,AA02,RR01,RR02,PPIA01,PPIA02
        COMMON/RO/ RO00
        COMMON/ANGLE/ BET1,BET2, Y201,YY202,Y401,YY402
        COMMON/G/ GAM,GAS
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        A01=AA01
        A02=SB2
        R01=RR01
        R02=RR02
        Y202 = YY202
        Y402 = YY402
        X=2.*GAM*GAM*P*R
        EX=DEXP((P-R02)/A02)
        FC = RO00*4.*(GAM*GAM/PI)**1.5*SB2F
        FUN3A=FC*R02*BET2*DSQRT(5.*PI)*Y202/A02*P*P*
     /  DEXP(-GAM*GAM*(P*P+R*R))*
     /  ((3./X/X/X+1./X)*DSINH(X)-3./X/X*DCOSH(X))*
     /  EX/(1.+EX)/(1.+EX)+
     /   FC*BET2*BET2*R02*R02/2.*
     /   FUN34A(P,A02,R02,Y202,Y402,1.D0)/A02/A02
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN12(P,A01,A02,R01,R02,PIA01,PIA02)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/ACCUR/ KEY12,KEY13
        DJ2(X) = 3.*DSIN(X)/X/X/X-DSIN(X)/X-3.*DCOS(X)/X/X
        COTH (X) = 1/DTANH(X)
        BET = 0.0
        PIA02R = PI*A02/R02
        CHSH = -DCOSH(R01/A01)/DSINH(R01/A01)/A01
        SR1 = DSIN(P*R01)
        SR2 = DSIN(P*R02)
        CR1 = DCOS(R01*P)
        CR2 = DCOS(R02*P)
        IF(KEY12.EQ.1) THEN
        DO 11 I=0,N
        I2 = 2*I+1
        BET = BET + DEXP(-PIA02*P*I2)/(R02*R02+PIA02*PIA02*I2*I2)*
     /   (-2.*R02/(R02*R02+PIA02*PIA02*I2*I2)*(R02*CR2+PIA02*I2*SR2)+
     /   (PIA02*P*I2+1)*CR2-P*R02*SR2)
  11    CONTINUE
        BETTA = PI*(DEXP(-R02/A02)/A02/(1+DEXP(-R02/A02))/(1+DEXP(-R02/
     /    A02)) - 2.*A02*BET)
        ELSE
      BETTA = SR2/R02+PIA02*PIA02/6.*(-P*P*SR2/R02-2.*P*CR2/R02/R02
     /   +2.*SR2/R02/R02/R02)
        ENDIF
        FUN12=DJ2(P*R)/DSINH(PIA01*P)*(CHSH*(PIA01*SR1*COTH(PIA01*P)-
     /    R01*CR1)+PIA01*P*CR1*
     /    COTH(PIA01*P)-CR1+P*R01*SR1)*(3/P/P*BETTA-PIA02/DSINH(PIA02*P)
     /    *(PIA02*P*CR2/DSINH(PIA02*P)*DCOSH(PIA02*P)+P*R02*DSIN(R02*P)
     /    +2.*CR2))
         RETURN
         END
C
        DOUBLE PRECISION FUNCTION FUN32(P,A02,R01,R02,PIA01,PIA02)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/ACCUR/ KEY12,KEY13
        DJ2(X) = 3.*DSIN(X)/X/X/X-DSIN(X)/X-3.*DCOS(X)/X/X
        COTH (X) = 1/DTANH(X)
        BET = 0.0
        PIA02R = PI*A02/R02
        SR1 = DSIN(P*R01)
        SR2 = DSIN(P*R02)
        CR1 = DCOS(R01*P)
        CR2 = DCOS(R02*P)
        IF(KEY12.EQ.1) THEN
        DO 11 I=0,N
        I2 = 2*I+1
        BET = BET + DEXP(-PIA02*P*I2)/(R02*R02+PIA02*PIA02*I2*I2)*
     /   (-2.*R02/(R02*R02+PIA02*PIA02*I2*I2)*(R02*CR2+PIA02*I2*SR2)+
     /   (PIA02*P*I2+1)*CR2-P*R02*SR2)
  11    CONTINUE
        BETTA = PI*(DEXP(-R02/A02)/A02/(1+DEXP(-R02/A02))/(1+DEXP(-R02/
     /    A02)) - 2.*A02*BET)
        ELSE
      BETTA = SR2/R02+PIA02*PIA02/6.*(-P*P*SR2/R02-2.*P*CR2/R02/R02
     /   +2.*SR2/R02/R02/R02)
        ENDIF
        FUN32 = DJ2(P*R)/DSINH(PIA01*P)*(PIA01*SR1*COTH(PIA01*P)-
     /    R01*CR1)*(3./P/P*BETTA-PIA02/DSINH(PIA02*P)
     /    *(PIA02*P*CR2/DSINH(PIA02*P)*DCOSH(PIA02*P)+P*R02*DSIN(R02*P)
     /    +2.*CR2))
         RETURN
         END
C
C
        DOUBLE PRECISION FUNCTION FUN13(P,A01,A02,R01,R02,PIA01,PIA02)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/ACCUR/ KEY12,KEY13
        DJ2(X) = 3.*DSIN(X)/X/X/X-DSIN(X)/X-3.*DCOS(X)/X/X
        COTH (X) = 1/DTANH(X)
        BET = 0.0
	PIA01Q = PIA01*PIA01
	R01Q = R01*R01
        PIA02R = PI*A02/R02
        SR1 = DSIN(P*R01)
        SR2 = DSIN(P*R02)
        CR1 = DCOS(R01*P)
        CR2 = DCOS(R02*P)
        IF(KEY13.EQ.1) THEN
        DO 11 I=0,N
        I2 = 2*I+1
	RPIQ = R01Q+PIA01Q*I2*I2
        BET = BET + DEXP(-PIA01*P*I2)/RPIQ*
     /   (-2.*R01/RPIQ*((
     /   (PIA01Q*A01*I2*I2-A01*R01Q)/RPIQ
     /    -R01+A01*A01*PI*P*I2)*CR1-(A01*P*R01+2.*PIA01*A01*R01*I2/
     /   RPIQ+PIA01*I2)*SR1)+
     /   (-2.*A01*R01/RPIQ+
     /   (2.*A01*R01Q*R01-2.*PIA01Q*A01*R01*I2*I2)/
     /   RPIQ/RPIQ-1.)*
     /   CR1-
     /  ((A01*PIA01Q*I2*I2-A01*R01Q)/RPIQ
     /  -R01+PIA01*A01*P*I2)*P*SR1-(A01*P+2.*PIA01*A01*I2/
     /  RPIQ-4.*A01*PIA01*R01Q*I2/
     /  RPIQ/RPIQ)*SR1-
     /  (A01*P*R01+2.*PIA01*A01*R01*I2/RPIQ+
     /  PIA01*I2)*P*CR1)
  11    CONTINUE
	DE = DEXP(-R01/A01)
        BETTA = PI*(2.*DE/(1.+DE)/(1.+DE)/(1.+DE)/A01+2.*A01*BET)
        ELSE
        BETTA = SR1/R01
     /   +PIA01Q/6.*
     /  ((-P*P/R01/R01+2./R01/R01/R01+1./R01/R01/A01
     /   )*SR1+(-P/R01/A01-2.*P/R01/R01)*CR1)
         ENDIF
        FUN13=DJ2(P*R)/DSINH(PIA02*P)*(PIA02*SR2/R02*COTH(PIA02*P)-
     /    CR2)*(3./P/P/A01*BETTA-PIA01/DSINH(PIA01*P)
     /    *(-(PIA01*COTH(PIA01*P)+3./P)*(-P*P*SR1-P*CR1/A01/
     /    DSINH(R01/A01)*DCOSH(R01/A01)+SR1/A01/A01/
     /    DSINH(R01/A01)/DSINH(R01/A01))-2.*P*SR1-P*P*R01*CR1-
     /    CR1/A01*COTH(R01/A01)+P*R01*SR1/A01*COTH(R01/A01)+
     /    R01*CR1/A01/A01/DSINH(R01/A01)/DSINH(R01/A01)))
         RETURN
         END
C
C
C
C
        DOUBLE PRECISION FUNCTION FUN34A(P,A02,R02,Y202,Y402,FAC)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/G/ GAM,GAS
        DIMENSION  DJ(5)
        X=FAC*2.*GAM*GAM*P*R
        DJ(1) = DSINH(X)/X
        DJ(2) = -DSINH(X)/X/X+DCOSH(X)/X
        DJ(3) = 3.*DSINH(X)/X/X/X+DSINH(X)/X-3.*DCOSH(X)/X/X
        DJ(4) = -5./X*DJ(3)+DJ(2)
        DJ(5) = -7./X*DJ(4)+DJ(3)
        EX = DEXP((P-R02)/A02)
        BET = 0.
        FP = 1.
        DO 11 I=0,4,2
        IF(I.EQ.2) FP=5./7.*Y202
        IF(I.EQ.4) FP=9./28.*Y402
        BET = BET + FP*DJ(I+1)
  11    CONTINUE
        FUN34A=P*P*BET*DEXP(-FAC*GAM*GAM*(P*P+R*R))*
     /  (-EX/(1.+EX)/(1.+EX)+2.*EX*EX/(1.+EX)/(1.+EX)/(1.+EX))
         RETURN
         END
C
C
        DOUBLE PRECISION FUNCTION FUN16A(P,A02,R02,Y201,Y401)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/G/ GAM,GAS
        DIMENSION  DJ(5)
        X=2.*GAM*GAM*P*R
        DJ(1) = DSINH(X)/X
        DJ(2) = -DSINH(X)/X/X+DCOSH(X)/X
        DJ(3) = 3.*DSINH(X)/X/X/X+DSINH(X)/X-3.*DCOSH(X)/X/X
        DJ(4) = -5./X*DJ(3)+DJ(2)
        DJ(5) = -7./X*DJ(4)+DJ(3)
        EX = DEXP((P-R02)/A02)
        BET = 0.
        FP = 1.
        DO 11 I=0,4,2
        IF(I.EQ.2) FP=5./7.*Y201
        IF(I.EQ.4) FP=9./28.*Y401
        BET = BET + FP*DJ(I+1)
  11    CONTINUE
        FUN16A=P*P*BET*DEXP(-GAM*GAM*(P*P+R*R))*
     /  (-2.*EX/(1.+EX)/(1.+EX)/(1.+EX)+
     /  6.*EX*EX/(1.+EX)/(1.+EX)/(1.+EX)/(1.+EX))
         RETURN
         END
C------------------------------------------------------------------------
        DOUBLE PRECISION FUNCTION FUNU(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/CON/ CONSTP,CONSTP2,CONSTP1,CHSH,CHSH2,FINN,FEXX
        COMMON/BBB/ A01,A02,R01,R02,PIA01,PIA02
        COMMON/RO/ RO00
        COMMON/CORR/ SB1,SB1F,SB1Q,SB1FQ, SB2,SB2F,SB2Q,SB2FQ, KEYS
        UA01=A01
        UA02=A02
        UPI1=PIA01
        UPI2=PIA02
        UCON=CONSTP
        IF(KEYS.EQ.2) A02=SB2
        IF(KEYS.EQ.1) A01=SB1Q
        IF(KEYS.EQ.3) THEN
        A01=SB1Q
        A02=SB2
        ELSE
        ENDIF
        PIA01=PI*A01
        PIA02=PI*A02
        C1=FUNU1(P)*CONSTP
        IF(KEYS.EQ.1.OR.KEYS.EQ.3) THEN
        A01=SB1
        CONSTP=CONSTP/SB1Q**2*SB1**2/SB1FQ*SB1F
        PIA01=PI*A01
        ELSE
        ENDIF
        C3=FUNU3(P)*CONSTP/A01
        IF(KEYS.EQ.2.OR.KEYS.EQ.3) A02=SB2Q
        PIA02=PI*A02
        C2=FUNU2(P)
        A01=UA01
        A02=UA02
        PIA01=UPI1
        PIA02=UPI2
        CONSTP=UCON
        FUNU=(FINN-FEXX)/RO00*(C1+CONSTP2*C2)-FEXX*C3/RO00
        RETURN
        END
C
        DOUBLE PRECISION FUNCTION FUNU1(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/CON/ CONSTP,CONSTP2,CONSTP1,CHSH,CHSH2,FINN,FEXX
        COMMON/BBB/ A01,A02,R01,R02,PIA01,PIA02
        COTH (X) = 1/DTANH(X)
        PIA02R = PI*A02/R02
        SR1 = DSIN(P*R01)
        SR2 = DSIN(P*R02)
        CR1 = DCOS(R01*P)
        CR2 = DCOS(R02*P)
        FUNU1=(CHSH*(PIA01*SR1*COTH(PIA01*P)-R01*CR1)+PIA01*P*CR1*
     /    COTH(PIA01*P)-CR1+P*R01*SR1)/DSINH(PIA01*P)/DSINH(PIA02*P)
     /    *(PIA02R*SR2*COTH(PIA02*P)-CR2)*DSIN(R*P)/P/R
	RETURN
	END
C
        DOUBLE PRECISION FUNCTION FUNU2(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/CON/ CONSTP,CONSTP2,CONSTP1,CHSH,CHSH2,FINN,FEXX
        COMMON/BBB/ A02,A01,R02,R01,PIA02,PIA01
        COTH (X) = 1/DTANH(X)
        PIA02R = PI*A02/R02
        SR1 = DSIN(P*R01)
        SR2 = DSIN(P*R02)
        CR1 = DCOS(R01*P)
        CR2 = DCOS(R02*P)
        FUNU2=(CHSH2*(PIA01*SR1*COTH(PIA01*P)-R01*CR1)+PIA01*P*CR1*
     /    COTH(PIA01*P)-CR1+P*R01*SR1)/DSINH(PIA01*P)/DSINH(PIA02*P)
     /    *(PIA02R*SR2*COTH(PIA02*P)-CR2)*DSIN(R*P)/P/R
	RETURN
	END
C
        DOUBLE PRECISION FUNCTION FUNU3(P)
        IMPLICIT DOUBLE PRECISION(A-H,O-Z)
        COMMON/AAA/ R,CONST12,CONST13,CONST22,CONST23,PI,N
        COMMON/CON/ CONSTP,CONSTP2,CONSTP1,CHSH,CHSH2,FINN,FEXX
        COMMON/BBB/ A01,A02,R01,R02,PIA01,PIA02
        COTH (X) = 1/DTANH(X)
        PIA02R = PI*A02/R02
        SR1 = DSIN(P*R01)
        SR2 = DSIN(P*R02)
        CR1 = DCOS(R01*P)
        CR2 = DCOS(R02*P)
        FUNU3=(PIA01*SR1*COTH(PIA01*P)-R01*CR1)
     /    /DSINH(PIA01*P)/DSINH(PIA02*P)
     /    *(PIA02R*SR2*COTH(PIA02*P)-CR2)*DSIN(R*P)/P/R
	RETURN
	END
C-------------------------------------------------------------------------
